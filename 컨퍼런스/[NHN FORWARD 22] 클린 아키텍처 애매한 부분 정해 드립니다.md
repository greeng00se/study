https://www.youtube.com/watch?v=g6Tg6_qpIVc

## 소프트웨어 아키텍처의 중요성

### 소프트웨어 아키텍처란?

- 소프트웨어가 제공하는 가치 중 구조에 해당 된다.

기능보다 구조가 중요하다?

좋은 아키텍처는 왜 중요할까?

신규 프로젝트 시 기능에 초점을 많이 둔다.

실제로는 유지보수를 많이 한다.

- 유지보수 → 읽고, 이해하고, 수정하는 행위

따라서 기능 못지않게 구조가 중요하다.

소프트웨어 아키텍처의 목표 → 필요한 시스템을 만들고 유지보수하는 데 투입되는 인력을 최소화 하는 것

## 좋은 아키텍처를 구성하는 방법

생각거리 → 패러다임, 설계 원칙, 컴포넌트 응집성 원칙, 컴포넌트 결합 원칙

### 패턴 사용법

1. 일단 따라해보기
2. 원칙들을 학습하고 이해한 후에 다시 따라해보기
3. 프로젝트에 적용해보기
4. 고민이 되는 지점들은 원칙에 맞게, 크게 벗어나지 않는 선에서 타협하며 사용하기

### 계층형 아키텍처

전통적인 수평적 계층화

장점

- 구조가 단순하다.
- 처음 시작할 때 적합하다.
- 보편적이라 모두가 익숙하다.

단점

- 업무 도메인에 대해 아무 것도 말해주지 않는다.
- 소프트웨어가 커지고 복잡해지면 조직화에 도움이 되지 않는다.
- 데이터베이스 주도 설계를 유도한다.

### 클린 아키텍처

도메인이 중심(DI 이용)

장점

규칙이 단순하다.

도메인이 세부 사항에 의존하지 않는다.

- 비즈니스 규칙에 집중하기 쉽다.

단점

패키지 구조가 계층형보다 복잡하다.

익숙하지 않아 처음에 버벅일 수 있다.

레퍼런스가 적다.

## 클린 아키텍처

아래를 통합?

- 헥사고날 아키텍처
- BCE(Boundary-Control-Entity)
- DCI(Data, Context and Interaction)

중요도에 따라 계층을 나눈다.

의존성의 방향은 항상 안쪽, 고수준을 향한다.

클린 아키텍처를 공부할 때 헥사고날 아키텍처로 시작하는게 왜 좋을까?

→ 헥사고날이 클란 아키텍처의 기본 다이어그램과 가장 비슷하다.

### **계층형 아키텍처**

전통적인 수평적 계층화

장점

- 구조 단순
- 처음 시작할 대 적합
- 보편적이라 모두가 익숙함

단점

- 업무 도메인에 대해 아무것도 말해주지 않는다.
- 소프트웨어가 커지고 복잡해지면 조직화에 도움이 안된다.

### **기능 기반 패키지**

서로 연관된 기능, 도메인 개념에 따라 수직의 얇은 조각으로 나뉜다.

수평적 계층화의 문제를 깨닫고 수직적 계층화로 넘어오는 경욱가 많다.

장점

- 코드의 상위 수준 구조가 업무 도메인에 대해 무언가를 알려준다.
- 유스케이스가 변경될 경우 변경해야 할 코드를 모두 찾는 작업이 쉬워진다.

단점

- 계층 구조가 분리되지 않는다.

### **포트와 어댑터**

수직, 수평으로 나눈다.

DB 계층에 대한 의존성 역전

장점

- 도메인이 다른 세부 사항에 의존하지 않는다.
- 수직, 수평형 계층 구조의 장점을 모두 가진다.

단점

- 클래스와 패키지 구조가 더 많아진다.

## 클린 아키텍처는 애매합니다.

### 애매한 것을 판단할 기준

1. 유지보수시 투입되는 인력 최소화에 유리한가?
2. 소스 코드의 의존성이 고수준의 정책을 향하고 있는가?
3. 세부 사항이 변경되어도 도메인의 변경이 없는가?
4. 테스트하기 쉬운가?
5. 각각의 아키텍처 원칙들을 잘 지키고 있는가?

### 이럴 땐 쓰지마세요

소규모의 프로젝트를 진행할 때

프로젝트 개발자 모두가 클린 아키텍처를 이해하고 있지 않거나, 모두가 사용하기로 합의하지 않았을 때

### 발표자 기준 클린 아키텍처 적용시  파일 및 패키지 증가율

라인 수 → 약 1.15배

파일 수 → 약 1.5배

패키지 수 → 약 4배

### 원칙을 전부 다 지켜야하는가?

→ 알작딱깔센

### JPA 엔티티, 도메인 엔티티 분리해야 하나요?

하나로 쓰면

- 클래스 패키지 구조 단순화
- 영속성 계층과 도메인 계층 강결합
- 도메인 엔티티 다룰 때 연관 관계 매핑, 즉시 로딩/지연 로딩 고려
- 분리하지 않으면 클린 아키텍처는 아님

분리하면

- 핵심 업무 규칙에 대한 고민에 집중

### JPA Repository는 어디에 해당되나요?

출력 포트가 아니라 어댑터에 해당된다.

출력  포트는 유스케이스가 필요로 하는 형태되로 유지되어야 한다.

유스 케이스가 DB의 세부사항(ex) 샤딩 등)의 변경에 의해 바뀌어야 한다면 클린 아키텍처가 아니다.

적어도 출력 포트의 로직이 한 번의 호출로 해결되지 않게 되면 분리해야 한다.

### 유스케이스가 다른 유스케이스를 호출해야 할 때?

컴포넌트를 별도 코드 베이스로 분리하려는게 아니라면 직접 호출

직접 호출해도 의존성 규칙에 위배되지 않는다.

별도 코드 베이스로 분리하려면 포트를 통해서 노출, 호출하도록 변경한다.

### 유즈케이스를 꼭 인터페이스로 뽑아야 하나?

구현체가 하나라도 인터페이스로 뽑아야 한다.

사고의 경계를 그어주는 역할이다.
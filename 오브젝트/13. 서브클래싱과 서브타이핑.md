# 13. 서브클래싱과 서브타이핑

### 상속의 용도

- 타입 계층을 구현하는 것
- 코드 재사용
- 이처럼 상속은 타입 계층을 구현할 수 있는 쉬운 방법을 제공한다

### 타입

- 개념관점 → 객체들에 적용하는 개념이나 아이디어
- 타입은 다음과 같이 세 가지 요소로 구성된다.
    - 심볼 → 타입의 이름
    - 내연 → 타입의 정의, 객체들이 가지고 있는 공통적인 속성
    - 외연 → 타입에 속하는 객체들의 집합
- 프로그래밍 언어 관점에서 타입 → 동일한 오퍼레이션을 적용할 수 있는 인스턴스의 집합
- 객체지향 패러다임 관점에서 타입 → 객체가 수신할 수 있는 메시지의 종류를 정의하는 것

### 슈퍼타입과 서브타입

- 슈퍼타입
    - 집합이 다른 집합의 모든 멤버를 포함한다.
    - 타입 정의가 다른 타입보다 일반적이다.
- 서브타입
    - 집합에 포함되는 인스턴스들이 더 큰 집합에 포함된다.
    - 타입 정의가 다른 타입보다 구체적이다.

서브타입의 인스턴스는 슈퍼타입의 인스턴스로 간주될 수 있다.

객체지향 프로그래밍 언어에서 타입을 구현하는 일반적인 방법은 클래스를 이용하는 것이다.

### 상속은 언제 사용해야 하는가

아래의 두가지를 모두 만족해야 한다.

- is-a 관계 → 자식 클래스는 부모 클래스다.
- 행동 호환성 → 클라이언트 입장에서 차이점을 몰라야 한다.

### 서브클래싱과 서브타이핑

- 서브클래싱
    - 다른 클래스의 코드를 재사용할 목적으로 상속을 사용하는 경우
    - 행동 호환성 X
    - 구현 상속 클래스 상속이라고 한다.
- 서브타이핑
    - 타입 계층을 구성하기 위해 상속을 사용하는 경우
    - 자식 클래스가 부모 클래스를 대체할 수 있다.
    - 행동 호환성을 만족시켜야 한다. 이는 곧 대체 가능성을 의미한다.
    - 인터페이스 상속
    

### LSP(Liskov Substitution Principle)

- 서브타입은 그것의 기반 타입에 대해 대체 가능해야 한다.
- 행동 호환성을 설계 원칙으로 정리한 것
- 리스코프 치환 원칙은 개방-폐쇄 원칙을 만족하는 설계를 위한 전제 조건이다.
- 리스코프 치환 원칙의 위반은 잠재적인 개방-폐쇄 원칙 위반이다.

### 8장의 중복 할인 정책

Movie → DiscountPolicy ← [AmountDiscountPolicy, PercentDiscountPolicy, OverlappedDiscountPolicy]

- DIP → Movie와 자식 클래스 모두 DiscountPolicy에 의존한다.
- LSP → 협력하는 Movie의 관점에서 자식 클래스와 협력해도 아무런 문제가 없다.
- OCP → 새로운 자식 클래스를 추가하더라도 Movie에 영향을 끼치지 않는다. 기능 확장과 동시에 기존 코드를 수정할 필요가 없다.

클라이언트 관점에서 자식 클래스가 부모 클래스를 대체할 수 있다는 것은 무엇을 의미하는가?

### DBC(계약에 의한 설계)와 서브 타이핑

사전조건 → 클라이언트가 정상적으로 메서드를 실행하기 위해 만족시켜야하는 것

사후조건 → 메서드가 실행 후에 서버가 클아이너트에게 보장해야 하는 조건

클래스 불변식 → 메서드 실행 전과 실행 후에 인스턴스가 만족시켜야 하는 것

서브 타입이 LSP를 만족시키기 위해서 클라이언트와 슈퍼타입 간에 체결된 계약을 준수해야 한다.

서브 타입에 더 강력한 사전 조건을 정의할 수 없다. 클라이언트의 경우 슈퍼타입의 사전 조건만 알고 있기 때문이다.

서브 타입에 더 강력한 사후 조건을 정의할 수 있다. 클라이언트와 슈퍼타입 간 체결된 계약에 영향을 미치지 않는다.
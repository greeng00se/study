> 오브젝트를 읽고 정리한 글입니다.
> 

### 개요

- 1장에서는 티켓 판매 애플리케이션을 구현하고, 책임의 분산을 통해 객체가 자율적인 존재가 되도록 리팩토링하는 내용을 담고 있습니다.
- 저는 객체의 책임과 자율성에 중점을 두고 1장을 읽었습니다.

### 책임

- 객체지향의 세계에서는 어떤 객체가 어떤 요청에 대해 대답하거나 적절한 행동을 할 의무가 있는 경우 해당 객체가 책임을 가진다고 말합니다.
- 책임에는 객체가 무엇을 아는가(knowing)와 무엇을 할 수 있는가(doing)로 구성됩니다.

### 자율성

- 자율성은 자기 스스로의 원칙에 따라 어떤 일을 하거나 통제해서 절제하는 성질이나 특성을 말합니다.
- 자율적인 객체란 스스로의 의지와 판단에 따라 각자 맡은 책임을 수행하는 객체를 의미합니다.
- 적절한 책임은 자율적인 객체를 낳고, 자율적인 객체들이 모여 유연하고 단순한 협력을 만들어갑니다.

### 티켓 판매 애플리케이션 요구사항

- 추첨을 통해 선정된 관람객은 무료로 공연을 관람할 수 있습니다.
- 추첨에 선정된 관람객은 초대장을 받습니다.
- 입장 방식
    - 당첨된 관람객은 초대장을 티켓으로 교환하여 입장해야 합니다.
    - 당첨되지 않은 관람객은 티켓을 구매하여 입장해야 합니다.

### 개선 전

- 리팩토링을 하기 전 극장 클래스의 코드는 다음과 같습니다.

```java
public class Theater {

    private TicketSeller ticketSeller;

    public Theater(TicketSeller ticketSeller) {
        this.ticketSeller = ticketSeller;
    }

    public void enter(Audience audience) {
        if (audience.getBag().hasInvitation()) {
            Ticket ticket = ticketSeller.getTicketOffice().getTicket();
            audience.getBag().setTicket(ticket);
        } else {
            Ticket ticket = ticketSeller.getTicketOffice().getTicket();

            audience.getBag().minusAmount(ticket.getFee());
            ticketSeller.getTicketOffice().plusAmount(ticket.getFee());

            audience.getBag().setTicket(ticket);
        }
    }
}
```

- 극장 클래스를 보면 `enter` 메서드가 수행하는 일이 매우 복잡하다는 것을 알 수 있습니다.
- 극장 클래스는 너무 많은 클래스에 의존하고 있기 때문에(결합도가 높은 상태) 변경에도 취약합니다.
- 또한 다른 객체들이 극장의 통제를 받아 수동적으로 동작하는 것을 알 수 있습니다.
- 개선 전의 코드는 객체들의 자율성이 떨어지고, 극장 클래스가 너무 많은 책임을 가지고 있는 상태입니다.

### 개선 후

- 책의 1.3(설계 개선하기)에서는 판매원, 관람객, 가방, 매표소가 자율적인 존재가 되도록 개선하고 있습니다.
- 자율적인 존재가 될 수록 객체의 응집도가 높아집니다.
    - 응집도가 높은 객체란 객체가 책임에 대한 부분만을 처리하고, 연관성 없는 작업을 다른 객체에게 위임하는 것을 말합니다.
- 객체를 자율적인 존재로 만드는 개선 작업 후 극장의 코드는 다음과 같습니다.

```java
public class Theater {

    private TicketSeller ticketSeller;

    public Theater(TicketSeller ticketSeller) {
        this.ticketSeller = ticketSeller;
    }

    public void enter(Audience audience) {
        ticketSeller.sellTo(audience);
    }
}
```

- 개선 후의 극장은 판매원에게 티켓을 판매하라는 책임을 수행하라고 요청 할 뿐 다른 동작은 하지 않습니다.
- 이러한 요청을 메시지 전송이라고 하고 객체들은 메시지 전송을 통해 협력합니다.

### 자율적인 책임의 이점

- 객체의 역할을 이해하기 쉬워집니다.
    - 개선 후 책임이 분산되었기 때문에 해당 객체가 어떠한 역할을 하는지 더 명확하게 알 수 있습니다.
- 객체의 외부와 내부를 명확하게 분리합니다.
    - 극장 클래스를 보면 판매원 클래스의 외부 인터페이스에만 의존하고 있습니다.
    - 외부에서 접근 가능한 부분을 인터페이스, 내부에서만 접근 가능한 부분인 구현으로 나누는 것은 객체 사이의 결합도를 낮추고, 변경하기 쉬운 코드를 작성하기 위해 따라야 하는 가장 기본적인 설계 원칙입니다.
- 책임을 수행하는 내부적인 방법에 변경이 있더라도 외부에 영향을 미치지 않습니다.

### 정리

- 책임이 자율적일수록 객체지향적인 특성이 드러납니다.
- 응집도가 높아지고, 결합도가 낮아지며, 캡슐화가 증진되고, 인터페이스와 구현이 명확히 분리되며, 유연성과 재사용성이 향상됩니다.
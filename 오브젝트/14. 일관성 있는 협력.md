### 일관성 있는 협력

일관성 있는 협력 패턴을 사용하면 코드가 이해하기 쉽고 직관적이며 유연해진다.

전체적인 설계의 일관성을 가져야하고 협력 구조를 유사하게 만들어야 한다.

객체지향에서는 변경을 다룰 때 조건 로직을 `if-else`, `switch-case`가 아닌 객체 사이의 이동으로 바꾼다

### 변하는 개념을 변하지 않는 개념으로부터 분리하라

타입 계층을 구성하고, 해당 타입 계층을 클라이언트로 분리하기 위해 역할을 도입하고, 역할을 추상 클래스와 인터페이스로 구현한다.

변하는 개념을 별도의 서브타입으로 분리한 후 서브타입들을 클라이언트로부터 캡슐화한다.

### 변하는 개념을 캡슐화하라

훌륭한 추상화를 찾아 추상화에 의존하도록 만든다.

추상화에 대한 의존은 결합도를 낮추고 대체 가능한 역할로 구성된 협력을 설계할 수 있다.

### 캡슐화

캡슐화는 변하는 개념을 감추는 것이다.

데이터 캡슐화, 객체 캡슐화, 메서드 캡슐화, 서브 타입 캡슐화와 같이 변하는 개념을 감추는 것이다.

데이터 → 데이터에 대한 접근을 제한하는 것, 접근 방법은 메서드를 이용하는 것

메서드 → 메서드의 내부 행동을 외부에서 접근하지 못하게 하여 캡슐화

객체 → 객체 캡슐화는 합성을 의미한다. 객체와 객체 사이의 관계를 캡슐화한다.

서브타입 캡슐화 → 다형성의 기반이 된다. Movie → DiscountPolicy는 알고 있지만 그 아래는 모르는 것 DBC

### 서브타입 캡슐화와 객체 캡슐화를 적용하는 법

변하는 부분을 분리해서 타입 계층을 만든다. → 변하는 부분은 변하지 않는 부분의 서브타입이 된다.

변하지 않는 부분을 일부로 타입 계층을 합성한다. → 타입 계층을 변하지 않는 부분에 합성한다. 추상화에만 의존하게 만든다. 변하지 않는 부분은 변하는 부분의 구체적인 종류에 대해서는 모르게 만든다.

### 개념적 무결성(Conceptual Integrity)

= 일관성

유사한 기능에 대해 유사한 협력 패턴을 적용하는 것은 객체지향 시스템에서 개념적 무결성을 유지할 수 있는 가장 효과적인 방법이다.

개념적 무결성을 유지하려면 지속적으로 개선해야 한다.

- 초기 단계에서 모든 요구사항을 미리 예상할 수 없다.
- 협력은 고정된 것이 아니다. 현재의 협력 패턴이 변경의 무게를 지탱하기 어렵다면 과감하게 리팩터링해야 한다.

변경을 캡슐화할 수 있는 패턴을 찾아 적절하게 추상화 한 후, 해당 추상화에 공통적인 책임을 할당한다.